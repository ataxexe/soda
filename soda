#!/bin/sh

[[ -z "$SODA_DIR" ]] && SODA_DIR=$(pwd)
[[ -z "$SODA_USER_DIR" ]] && SODA_USER_DIR=$HOME/.soda

. $SODA_DIR/soda.conf
. $SODA_DIR/scripts/core.sh

if [[ -f "$SODA_USER_DIR/soda.conf" ]]; then
  . $SODA_USER_DIR/soda.conf
fi

SODA_RESOURCES=$SODA_USER_DIR/resources

function usage {
  import_all_namespaces

  echo "Usage: $(basename $0) [*PARAMETERS] FUNCTION [*ARGS]"
  printf "$PARAMETERS_USAGE\n\n"
  printf "$TASKS_USAGE\n"
  exit 1
}

SODA_PARAMETERS=""

for arg in "${@}"; do
  case $arg in
    --*)
      SODA_PARAMETERS="$SODA_PARAMETERS $arg"
      set_parameter "$arg"
      shift
      ;;
  esac
done

# Imports common and soda namespace
import soda
import common

[[ "$#" = "0" ]] && usage

call "$@"

finish
